<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="page-title">Tica ä¾¦æ¢äº‹åŠ¡æ‰€ï¼šæ•°å­—è°œæ¡ˆ</title>
    <link rel="icon" type="image/png" href="/favicon.png" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="theme-color" content="#0b1021" />
  </head>
  <body style="margin:0;background:#0b1021;color:#fff;">
    <div id="game"></div>
    <script type="module" src="./main.ts"></script>

    <!-- å¼€å‘ç¯å¢ƒè°ƒè¯•é¢æ¿ -->
    <div id="debug-panel" style="display:none; position:fixed; top:10px; right:10px; background:rgba(0,0,0,0.8); color:white; padding:15px; border-radius:8px; font-family:monospace; font-size:12px; z-index:9999; min-width:200px;">
      <h4 id="debug-panel-title" style="margin:0 0 10px 0; color:#4CAF50;">ğŸ® æ¸¸æˆè°ƒè¯•é¢æ¿</h4>
      <div style="margin-bottom:10px;">
        <label id="debug-set-level" style="display:block; margin-bottom:5px;">è®¾ç½®å…³å¡:</label>
        <input type="number" id="debug-level" value="1" min="1" max="100" style="width:100%; padding:5px;">
        <button id="debug-apply" onclick="applyDebugLevel()" style="width:100%; margin-top:5px; padding:5px; background:#4CAF50; color:white; border:none; border-radius:3px; cursor:pointer;">åº”ç”¨</button>
      </div>
            <div style="margin-bottom:10px;">
        <button id="debug-reset" onclick="resetDebugGame()" style="width:100%; padding:5px; background:#f44336; color:white; border:none; border-radius:3px; cursor:pointer;">é‡ç½®æ¸¸æˆ</button>
      </div>
      <div>
        <button id="debug-hide" onclick="toggleDebugPanel()" style="width:100%; padding:5px; background:#666; color:white; border:none; border-radius:3px; cursor:pointer;">éšè—é¢æ¿</button>
      </div>
    </div>

    <script>
      // è°ƒè¯•é¢æ¿åŠŸèƒ½
      function applyDebugLevel() {
        const level = parseInt(document.getElementById('debug-level').value);
        if (window.DebugHelper && window.DebugHelper.setLevel(level)) {
          setTimeout(() => window.location.reload(), 100);
        }
      }

      // addDebugToolså·²ç§»é™¤ - è°ƒè¯•æ¨¡å¼ä¸‹é“å…·æ— é™

      function resetDebugGame() {
        const confirmText = window.Strings ? window.Strings.debug.confirm_reset : 'ç¡®å®šè¦é‡ç½®æ¸¸æˆå—ï¼Ÿ';
        if (confirm(confirmText)) {
          if (window.DebugHelper && window.DebugHelper.resetGame()) {
            setTimeout(() => window.location.reload(), 100);
          }
        }
      }

      function toggleDebugPanel() {
        const panel = document.getElementById('debug-panel');
        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
      }

      // æ›´æ–°é¡µé¢æ–‡æœ¬ä¸ºå½“å‰è¯­è¨€
      function updatePageText() {
        if (!window.Strings) return;

        // æ›´æ–°é¡µé¢æ ‡é¢˜
        document.getElementById('page-title').textContent = window.Strings.ui.title;

        // æ›´æ–°è°ƒè¯•é¢æ¿æ–‡æœ¬
        const debug = window.Strings.debug;
        document.getElementById('debug-panel-title').textContent = debug.panel_title;
        document.getElementById('debug-set-level').textContent = debug.set_level;
        document.getElementById('debug-apply').textContent = debug.apply;
        document.getElementById('debug-reset').textContent = debug.reset_game;
        document.getElementById('debug-hide').textContent = debug.hide_panel;
      }

      // å»¶è¿Ÿæ‰§è¡Œåˆå§‹åŒ–ä»»åŠ¡ï¼Œç­‰å¾…æ¨¡å—åŠ è½½å®Œæˆ
      setTimeout(() => {
        updatePageText();

        // è°ƒè¯•æ¨¡å¼ä¸‹æ˜¾ç¤ºè°ƒè¯•é¢æ¿
        if (window.DebugHelper && window.DebugHelper.isDebugMode()) {
          document.getElementById('debug-panel').style.display = 'block';
        }
      }, 1000);

      // å¿«æ·é”®æ”¯æŒ
      document.addEventListener('keydown', (e) => {
        // Ctrl+Shift+D åˆ‡æ¢è°ƒè¯•é¢æ¿
        if (e.ctrlKey && e.shiftKey && e.key === 'D') {
          e.preventDefault();
          toggleDebugPanel();
        }
        // Ctrl+Shift+L å¿«é€Ÿè®¾ç½®å…³å¡
        if (e.ctrlKey && e.shiftKey && e.key === 'L') {
          e.preventDefault();
          const promptText = window.Strings ? window.Strings.debug.enter_level : 'è¾“å…¥å…³å¡æ•° (1-100):';
          const level = prompt(promptText);
          if (level && !isNaN(level)) {
            document.getElementById('debug-level').value = parseInt(level);
            applyDebugLevel();
          }
        }
      });
    </script>
  </body>
</html>
